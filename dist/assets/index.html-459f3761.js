import{r as o,j as e,R as N,c as E}from"./client-24a33b86.js";import{M as w,B as M,a as D,b as L}from"./common.constants-50715200.js";import{g as A,a as P,u as T}from"./utils-4c3eb42e.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function i(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(t){if(t.ep)return;t.ep=!0;const n=i(t);fetch(t.href,n)}})();const b=o.createContext({contexts:[],isLoading:!1,isSaving:!1,error:null,saveError:null,addNewContext:async()=>{},updateContext:async()=>{},charactersCount:0}),k=({children:s})=>{const[a,i]=o.useState([]),[l,t]=o.useState(!1),[n,r]=o.useState(!1),[m,h]=o.useState(null),[c,u]=o.useState(null),[x,d]=o.useState(0),j=o.useCallback(()=>{const f=a.reduce((C,p)=>C+p.title.length+p.description.length,0);d(f)},[a]);o.useEffect(()=>{j()},[a,j]);const y=async()=>{t(!0),h(null);try{const f=await A();i(f),t(!1)}catch(f){t(!1),console.log("Error fetching contexts",f),h("Error fetching contexts, please try again!")}};o.useEffect(()=>{y()},[]);const g=async f=>{const C={id:Date.now(),...f};r(!0),u(null);try{await P(C),i(p=>[...p,C]),r(!1)}catch(p){r(!1),console.log("Error adding context",p),u("Error adding context, please try again!")}},v=async f=>{r(!0),u(null);try{await T(f),i(C=>C.map(p=>p.id===f.id?f:p)),r(!1)}catch(C){r(!1),console.log("Error updating context",C),u("Error updating context, please try again!")}};return e.jsx(b.Provider,{value:{contexts:a,isLoading:l,isSaving:n,error:m,saveError:c,addNewContext:g,updateContext:v,charactersCount:x},children:s})},S=({context:s,onChange:a,onSave:i,onCancel:l,isEditForm:t})=>{const{charactersCount:n}=o.useContext(b),[r,m]=o.useState(0),[h,c]=o.useState(0),[u,x]=o.useState(!1),[d,j]=o.useState(!1),y=!s.title.trim()||!s.description.trim();return o.useEffect(()=>{t&&!u?(m(n-s.title.length-s.description.length),x(!0)):t||(m(n),x(!1))},[n,s.title,s.description,t]),o.useEffect(()=>{const g=r+s.title.length+s.description.length,v=w-g<0;v||c(g),j(v)},[r,s.title,s.description]),e.jsxs("div",{className:"w-full flex flex-col gap-y-3",children:[e.jsx("input",{id:"title",type:"text",value:s.title,placeholder:"Title",className:"secondary-input-box",onChange:g=>a("title",g.target.value),autoFocus:!0}),e.jsx("textarea",{id:"description",value:s.description,placeholder:"Description",rows:12,className:"secondary-input-box",onChange:g=>a("description",g.target.value)}),e.jsx("p",{className:`font-normal text-xs text-right ${d?"text-red-600":"text-gray-400"}`,children:d?`You've exceeded limit of ${w.toLocaleString()} characters`:`${h.toLocaleString()} / ${w.toLocaleString()} characters`}),e.jsxs("div",{className:"btn-group flex justify-start gap-x-3",children:[e.jsx("button",{className:d||y?"btn-primary-disabled":"btn-primary",onClick:i,disabled:d||y,children:"Save"}),e.jsx("button",{className:"btn-outlined",onClick:l,children:"Cancel"})]})]})},I=({onSaved:s})=>{const[a,i]=N.useState({title:"",description:""}),{addNewContext:l}=o.useContext(b),t=()=>{chrome.runtime.sendMessage({action:"getPageData"},c=>{c&&i(c.pageData)})},n=c=>{c.action==="updatePageData"&&t()};o.useEffect(()=>(t(),chrome.runtime.onMessage.addListener(n),()=>chrome.runtime.onMessage.removeListener(n)),[]);const r=(c,u)=>{i({...a,[c]:u})},m=async()=>{a.title.trim()===""||a.description.trim()===""||(await l(a),chrome.runtime.sendMessage({action:"informModalToRefetchContexts"}),s())},h=()=>{chrome.runtime.sendMessage({action:"closeSidePanel"}),i({title:"",description:""})};return e.jsx("div",{className:"p-6 text-base flex flex-col gap-y-4 flex-1 bg-[#fafafa]",children:e.jsx(S,{context:a,onChange:r,onSave:m,onCancel:h})})},F=({context:s,isEditMode:a,onSave:i,onCancel:l})=>{const[t,n]=N.useState({title:s.title,description:s.description}),{updateContext:r}=o.useContext(b),m=(u,x)=>{n({...t,[u]:x})},h=async()=>{t.title.trim()===""||t.description.trim()===""||(await r({id:s.id,...t}),chrome.runtime.sendMessage({action:"informModalToRefetchContexts"}),i(t))},c=()=>{l()};return e.jsx("div",{className:"px-6 py-4 w-full flex-1 bg-[#fafafa]",children:a?e.jsx(S,{context:t,onChange:m,onSave:h,onCancel:c,isEditForm:!0}):e.jsxs("div",{className:"w-full text-black",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h1",{className:"text-2xl font-semibold",children:s.title})}),e.jsx("p",{className:"text-sm mt-4",children:s.description})]})})},B="/assets/step1-d4190943.svg",R="/assets/step2-38d2d908.svg",K=({item:s,onView:a})=>e.jsxs("div",{className:"bg-white rounded-lg text-black p-4 flex flex-col transition-all delay-75 duration-150 ease-linear hover:cursor-pointer hover:scale-105 hover:shadow-sm",onClick:()=>a(s),children:[e.jsx("h1",{className:"text-base font-semibold",children:s.title}),e.jsx("p",{className:"text-sm line-clamp-2 mt-2",children:s.description}),e.jsx("button",{className:"text-blue-600 font-bold w-fit mt-4 transition-all delay-75 duration-150 ease-linear hover:underline hover:underline-offset-4",children:"View More"})]}),O=({contextItems:s,onView:a})=>s.length===0?e.jsxs("div",{className:"px-6 flex flex-col justify-center items-center bg-[#fafafa] flex-1 gap-y-6",children:[e.jsxs("div",{className:"w-full text-center",children:[e.jsx("h3",{className:"text-xl text-black font-semibold",children:"Your Knowledgebase is empty"}),e.jsx("p",{className:"text-xs text-[#667085] font-normal mt-2",children:"Start by adding first context into your knowlegebase by following these quick steps:"})]}),e.jsxs("div",{className:"step-1 w-full flex flex-col items-center gap-y-[14px]",children:[e.jsx("img",{src:B,alt:"Select and Add to AutoAct",width:"40%"}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Select and Add to AutoAct"})]}),e.jsxs("div",{className:"step-2 w-full flex flex-col items-center gap-y-[14px]",children:[e.jsx("img",{src:R,alt:"Edit and Save to Knowledgebase",width:"40%"}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Edit and Save to Knowledgebase"})]})]}):e.jsx("div",{className:"px-6 py-4 flex flex-col space-y-4 bg-[#fafafa] flex-1 overflow-auto",children:s.map(i=>e.jsx(K,{item:i,onView:a},i.id))}),$=()=>{const{contexts:s}=o.useContext(b),[a,i]=o.useState(null),[l,t]=o.useState(!1),[n,r]=o.useState("contexts");o.useEffect(()=>{chrome.runtime.sendMessage({action:"getSidebarState"},d=>{d&&r(d.contentType)});const x=({action:d,contentType:j})=>{d==="updateSidebarContentType"&&j&&r(j)};return chrome.runtime.onMessage.addListener(x),()=>{chrome.runtime.onMessage.removeListener(x)}},[]);const m=x=>{i(x),t(!1)},h=x=>{i(d=>d?{...d,...x}:null),t(!1)},c=()=>{chrome.runtime.sendMessage({action:"scrappedPageData",pageData:{title:"",description:""}}),chrome.runtime.sendMessage({action:"openSidePanel",contentType:"addNewContext"}),r("addNewContext")},u=()=>{n==="contexts"?(i(null),t(!1)):(r("contexts"),chrome.runtime.sendMessage({action:"openSidePanel",contentType:"contexts"}))};return e.jsxs("div",{className:"text-base flex flex-col h-screen overflow-hidden",children:[e.jsxs("div",{className:"w-full px-6 py-[14px] bg-[#EDF0F9] flex items-center justify-between",children:[n==="contexts"&&!a&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Your Knowledgebase"}),e.jsxs("button",{className:"btn-primary flex items-center gap-x-1",onClick:c,children:[e.jsx(M,{size:18,color:"white"}),e.jsx("span",{children:"New"})]})]}),(a||n==="addNewContext")&&e.jsx("button",{className:"transition-all duration-150 delay-75 ease-linear text-black flex items-center gap-x-2 hover:text-blue-600",onClick:u,title:"Back to Knowledebase",children:e.jsx(D,{size:18})}),n==="addNewContext"?e.jsx("p",{className:"flex-1 text-center font-medium",children:"Add New Context"}):n==="contexts"&&a?l?e.jsx("p",{className:"flex-1 text-center font-medium",children:"Edit Context Details"}):e.jsx("p",{className:"font-medium",children:"Context Details"}):null,n==="contexts"&&a&&!l&&e.jsx("button",{className:"icon-btn hover:bg-white",onClick:()=>t(!0),children:e.jsx(L,{size:18,color:"black"})})]}),n==="contexts"&&(a?e.jsx(F,{context:a,isEditMode:l,onSave:h,onCancel:()=>t(!1)}):e.jsx(O,{contextItems:s,onView:m})),n==="addNewContext"&&e.jsx(I,{onSaved:()=>{chrome.runtime.sendMessage({action:"openSidePanel",contentType:"contexts"}),r("contexts"),i(null)}})]})};E.createRoot(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(k,{children:e.jsx($,{})})}));
